var e=Object.assign;import{B as a,j as t,d as n,r as l,N as o,$ as _,E as s,R as r,P as d,c as i,e as u,o as m,w as g,F as c,g as p,h as v,b as f,a as x}from"./index.6b048fe1.js";import{R as y}from"./rank.service.4283e077.js";import"./vendor.32f4224e.js";const h="/miniprogram/city/game/list/",w="/api/passerbyking/city/game/player/list/",k=e=>"test"===t("ll_env")?"http://test.liangle.com"+e:"http://m.liangle.com"+e;class V{static async load_player_list(e){let t=k(w+e),n=await a.get_proxy(t);if(n.data)return n.data}static async load_event_list(){let e=k(h),t=await a.get_proxy(e);if(t.data)return t.data}}var C=n({components:{},setup(a){const t=l({count:1,selected_event:null,game_arr:[]}),n=l({on_count:null,on_load_liangle_data:null,on_selected_event:null,on_enter_game:null,get_game_desc:null,on_load_event_list:null});n.get_game_desc=e=>e.idx+"  人数:"+e.player_arr.length,n.on_selected_event=()=>{var e;if(null==(e=t.selected_event)?void 0:e.id){let e=t.selected_event.id;n.on_load_liangle_data(e)}};const i=[],u=async()=>{let e=await V.load_event_list();(null==e?void 0:e.length)&&(o({type:"success",message:"刷新报名数据"}),i.length=0,e.map((e=>{i.push({text:e.title,value:e})})))};return u(),n.on_load_event_list=()=>{u()},n.on_enter_game=e=>{e.player_arr.length>2?(o({type:"success",message:"enter"}),_.emit(s.enter_game,e),r.to(d.TAB_JIFEN)):o({type:"danger",message:"人数不足"})},n.on_load_liangle_data=async e=>{e||(e="1801");let a=await V.load_player_list(e),n=[];if(a){o({type:"success",message:"!"});for(let e in a){let t={idx:e,player_arr:a[e]};n.push(t)}t.game_arr=n}},n.on_load_liangle_data(),e({state:t,event_arr:i,props:a},n)}});const b=v(" 刷新 "),j=v(" 进入 ");C.render=function(e,a,t,n,l,o){const _=f("van-dropdown-item"),s=f("van-dropdown-menu"),r=f("van-cell"),d=f("van-button"),v=f("van-cell-group");return m(),i("div",null,[u(r,{title:"比赛列表"},{default:g((()=>[u(s,null,{default:g((()=>[u(_,{modelValue:e.state.selected_event,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.selected_event=a),onChange:e.on_selected_event,options:e.event_arr},null,8,["modelValue","onChange","options"])])),_:1})])),_:1}),u(r,{title:"场次列表"},{default:g((()=>[u(d,{onClick:e.on_load_event_list},{default:g((()=>[b])),_:1},8,["onClick"])])),_:1}),u(v,null,{default:g((()=>[(m(!0),i(c,null,p(e.state.game_arr,((a,t)=>(m(),i(r,{key:t,title:a.idx,value:"get_game_desc(game)",label:e.get_game_desc(a)},{default:g((()=>[u(d,{onClick:t=>e.on_enter_game(a)},{default:g((()=>[j])),_:2},1032,["onClick"])])),_:2},1032,["title","label"])))),128))])),_:1})])};var U=n({components:{},setup:()=>({state:l({value1:0,value2:"a"}),option1:[{text:"管理员",value:0},{text:"球员",value:1},{text:"计分员",value:2}],role_option_arr:[{text:"管理员",value:0},{text:"球员",value:1},{text:"计分员",value:2}]})});U.render=function(e,a,t,n,l,o){const _=f("van-dropdown-item"),s=f("van-dropdown-menu");return m(),i(s,null,{default:g((()=>[u(_,{modelValue:e.state.value1,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.value1=a),options:e.role_option_arr},null,8,["modelValue","options"])])),_:1})};const R=[];var A=n({components:{Role:U,GameList:C},unmounted:()=>{_.remove(R),R.length=0},setup(a){y.init_event(),y.load_rank_doc();const t={on_edit_max_winning_streak:null,on_edit_group_name:null,on_load_liangle_data:null},n=x(5),l=x("A");return t.on_edit_max_winning_streak=e=>{y.state.max_winning_streak=n.value},t.on_load_liangle_data=async e=>{},t.on_edit_group_name=e=>{y.set_group_name(l.value)},e(e({state:{},max_winning_streak:n,group_name:l},t),{data:1})}});const B=u("span",{style:{"font-size":"20px"}},null,-1);A.render=function(e,a,t,n,l,o){const _=f("van-field"),s=f("GameList");return m(),i("div",null,[u(_,{onChange:e.on_edit_max_winning_streak,modelValue:e.max_winning_streak,"onUpdate:modelValue":a[1]||(a[1]=a=>e.max_winning_streak=a),label:"最大连胜",placeholder:"请输入"},null,8,["onChange","modelValue"]),u(_,{onChange:e.on_edit_group_name,modelValue:e.group_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.group_name=a),label:"场次名",placeholder:"请输入"},null,8,["onChange","modelValue"]),B,u(s)])};export default A;
