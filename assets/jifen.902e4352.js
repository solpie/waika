var e=Object.assign;import{_ as n}from"./rank-player.17ac45c0.js";import{R as a}from"./rank.service.4283e077.js";import{d as t,r as o,$ as l,E as r,D as s,N as _,c as p,e as u,k as c,p as d,l as i,b as m,o as y,h as v,L as f,i as w,a as h,F as k,g}from"./index.6b048fe1.js";import"./vendor.32f4224e.js";o({count:1});var b=t({components:{},emits:["on_update"],props:{player:null},setup(n,{emit:t}){const p=o({count:1,is_show_more:!0}),u=o({on_show_more:null,on_win_player:null});u.on_show_more=e=>{l.emit(r.jifen_show_actions,{player:n.player})};return u.on_win_player=()=>{let e=n.player;s.alert({title:"确认",message:"选手："+e.name+"胜出"}).then((()=>{a.win_player(e),_("选手："+e.name+"胜出"),(()=>{let e=n.player;a.is_player_winning_streak_need_down(e)&&s.confirm({title:"确认",message:"选手："+e.name+"已经"+e.winning_streak+"连胜，是否下场？",beforeClose:n=>("confirm"===n&&(a.down_player([e]),t("on_update")),!0)})})(),t("on_update")}))},e(e({state:p,props:n},u),{data:1})}});const j=c("data-v-36dfc881");d("data-v-36dfc881");const P=v(" 胜出 "),S=v(" 更多 ");i();const x=j(((e,n,a,t,o,l)=>{const r=m("van-cell"),s=m("van-cell-group"),_=m("van-col"),c=m("van-button"),d=m("van-row");return y(),p("div",null,[u(s,{title:e.props.player.idx+" "+e.props.player.name},{default:j((()=>[u(r,{title:"连胜："+e.props.player.winning_streak+" 积分："+e.props.player.score,size:"large"},null,8,["title"])])),_:1},8,["title"]),u(d,{justify:"space-around",gutter:"20"},{default:j((()=>[u(_,{span:"8"}),u(_,{span:"8"},{default:j((()=>[u(c,{type:"primary",size:"large",class:"btn-win",onClick:n[1]||(n[1]=n=>e.on_win_player())},{default:j((()=>[P])),_:1})])),_:1}),u(_,{span:"8"},{default:j((()=>[u(c,{type:"primary",onClick:n[2]||(n[2]=n=>e.on_show_more(1))},{default:j((()=>[S])),_:1})])),_:1})])),_:1})])}));b.render=x,b.__scopeId="data-v-36dfc881";var J=t({components:{},setup(n){const a=o({count:1,rec_arr:[]}),t=o({on_count:null,on_back_to:null});return t.on_count=e=>{},t.on_back_to=e=>{},f.get_item(f.RANK_KEY,(e=>{let n=JSON.parse(e);(null==n?void 0:n.rank_rec_arr)&&(a.rec_arr=[...n.rank_rec_arr])})),e({state:a,props:n},t)}});J.render=function(e,n,a,t,o,l){return m("van-button"),m("van-cell"),m("van-cell-group"),w("",!0)};const A=l,O=[];var R=t({components:{},unmounted:()=>{},setup(n){const t=o({count:1,selected_player:null}),r=o({on_count:null,onSelect:null});r.on_count=e=>{};const s=h(!1);var _,p;_=A.jifen_show_actions,p=e=>{s.value=!0,u[0].name=e.player.name+" 下场",t.selected_player=e.player},O.push(l.on(_,p)),r.onSelect=e=>{e.handle&&(e.handle(),s.value=!1)};const u=[{name:"下场",handle:()=>{t.selected_player&&a.down_player([t.selected_player])}},{name:"违体",handle:()=>{a.down_two_player()}},{name:"弃权",handle:()=>{t.selected_player&&a.delete_player(t.selected_player)}},{name:"双人下场",handle:()=>{a.down_two_player()}},{name:"回溯",handle:()=>{l.emit(A.jifen_show_history)}}];return e({state:t,menus:u,showPopover:s,props:n},r)}});R.render=function(e,n,a,t,o,l){const r=m("van-action-sheet");return y(),p(r,{show:e.showPopover,"onUpdate:show":n[1]||(n[1]=n=>e.showPopover=n),actions:e.menus,onSelect:e.onSelect},null,8,["show","actions","onSelect"])};const z=l,C=[];var N=t({components:{RankPlayer:n,JifenPlayer:b,History:J,JifenAction:R},unmounted:()=>{},setup(n){const t=a.state,r=o({on_commit_game:null,get_vs_title:null,on_change:null,on_win_player:null,on_down_winning_streak:null,on_edit_max_winning_streak:null,on_edit_group_name:null,on_update_rank:null}),s=o({checked_edit_mode:h(!1),max_winning_streak:h(5)});a.init_event(),a.load_rank_doc();var _,p;_=z.rank_jifen_vs_changed,p=()=>{a.load_rank_doc()},C.push(l.on(_,p)),r.on_change=()=>{},r.on_update_rank=()=>{a.load_rank_doc()};const u=h(5),c=h("A"),d=h(!0);return e(e({state:t,state_1:s,is_show_more:d,max_winning_streak:u,group_name:c},r),{on_count:e=>{a.count2(e)},data:1})}});const E=c("data-v-1a5dec95");d("data-v-1a5dec95");const H=v("VS");i();const I=E(((e,n,a,t,o,l)=>{const r=m("History"),s=m("JifenPlayer"),_=m("van-button"),c=m("van-col"),d=m("van-row"),i=m("RankPlayer"),v=m("van-cell-group"),f=m("JifenAction");return y(),p(k,null,[u(r),u("div",null,[u(d,null,{default:E((()=>[(y(!0),p(k,null,g(e.state.last_vs_arr,((e,n)=>(y(),p(c,{span:"24",key:n},{default:E((()=>[u(s,{player:e},null,8,["player"]),0==n?(y(),p(d,{key:0,justify:"center"},{default:E((()=>[u(c,{span:"24"},{default:E((()=>[u(_,{plain:"",disabled:"",type:"primary",size:"large"},{default:E((()=>[H])),_:1})])),_:1})])),_:1})):w("",!0)])),_:2},1024)))),128))])),_:1}),u(v,{title:"下一场："},{default:E((()=>[u(d,null,{default:E((()=>[(y(!0),p(k,null,g(e.state.player_arr,((n,a)=>(y(),p(k,{key:n.name},[a>1?(y(),p(i,{key:0,player:n,onOn_update:e.on_update_rank},null,8,["player","onOn_update"])):w("",!0)],64)))),128))])),_:1})])),_:1})]),u(f)],64)}));N.render=I,N.__scopeId="data-v-1a5dec95";export default N;
