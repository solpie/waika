var e=Object.assign;import{A as t,R as o}from"./auth.service.ad3837e7.js";import{d as a,D as n,r as s,L as i,a as l,N as r,o as u,c,w as _,e as d,b as m,t as f,q as h,$ as b,E as p,s as v,R as g,F as w,g as $,h as k,u as y,x as R}from"./index.6b048fe1.js";import"./vendor.32f4224e.js";const x={validateIDCard:e=>/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e),validatePhoneNumber:e=>/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e),validator:e=>/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e)};var N=a({components:{[n.Component.name]:n.Component},setup(o){const a=s({count:1,phone:""}),n=s({on_count:null,on_before_close:null,on_submit:null,validate_phone:x.validatePhoneNumber});i.get_item("ticket",(e=>{e?t.verify(e):u.value=!0}));const u=l(!1);return n.on_count=()=>{},n.on_submit=()=>{},n.on_before_close=e=>new Promise((async o=>{if("confirm"===e){if(x.validatePhoneNumber(a.phone)){await t.login(a.phone)&&o(!0)}else r({type:"danger",message:"请输入正确手机号"});o(!1)}else t.login_guest(),o(!0)})),e({state:a,is_show_login_dialog:u,props:o},n)}});N.render=function(e,t,o,a,n,s){const i=m("van-field"),l=m("van-form"),r=m("van-dialog");return u(),c(r,{show:e.is_show_login_dialog,"onUpdate:show":t[2]||(t[2]=t=>e.is_show_login_dialog=t),title:"登陆","show-cancel-button":"","before-close":e.on_before_close,"confirm-button-text":"login","cancel-button-text":"guest"},{default:_((()=>[d(l,{onSubmit:e.on_submit},{default:_((()=>[d(i,{modelValue:e.state.phone,"onUpdate:modelValue":t[1]||(t[1]=t=>e.state.phone=t),name:"phone",label:"手机号",placeholder:"手机号",rules:[{validator:e.validate_phone,required:!0,message:"请输入正确手机号"}]},null,8,["modelValue","rules"])])),_:1},8,["onSubmit"])])),_:1},8,["show","before-close"])};const P=a({components:{LoginDialog:N},setup(){const e=s({showPopover:!1,tabs:[...f],role:""}),a=g.with_query1,n=l(!1),i=l("stickyRef"),r=l("tabbarRef"),u=l("");h((()=>{u.value=i.value.$el.offsetHeight+r.value.$el.offsetHeight+"px"}));return b.on(p.login_role,(t=>{t===o.QIUYUAN&&(e.tabs=[...f])})),b.on(p.login_role,(t=>{t===o.ADMIN&&(e.tabs=[...v])})),{showPopover:n,state:e,on_show_menu:()=>{t.role!==o.QIUYUAN&&b.emit(p.rank_show_actions)},get_route_path:a,tabs:v,stickyRef:i,tabbarRef:r,containerHeight:u}}}),U=()=>{R((e=>({"003aa3de":e.containerHeight,"003aa3de":e.containerHeight})))},C=P.setup;P.setup=C?(e,t)=>(U(),C(e,t)):U;const D=P,H={class:"container"};D.render=function(e,t,o,a,n,s){const i=m("van-icon"),l=m("van-nav-bar"),r=m("van-sticky"),f=m("router-view"),h=m("van-tabbar-item"),b=m("van-tabbar"),p=m("LoginDialog");return u(),c(w,null,[d(r,{ref:"stickyRef"},{default:_((()=>{var t;return[d(l,{title:null==(t=e.$route.meta)?void 0:t.title},{left:_((()=>[d(i,{name:"wap-nav",size:"18",onClick:e.on_show_menu},null,8,["onClick"])])),right:_((()=>[d(i,{name:"search",size:"18"})])),_:1},8,["title"])]})),_:1},512),d("div",H,[d(f)]),d(b,{ref:"tabbarRef",route:""},{default:_((()=>[(u(!0),c(w,null,$(e.state.tabs,(t=>(u(),c(h,{to:e.get_route_path(t.path),icon:t.meta.icon},{default:_((()=>[k(y(t.meta.title),1)])),_:2},1032,["to","icon"])))),256))])),_:1},512),d(p)],64)};export default D;
