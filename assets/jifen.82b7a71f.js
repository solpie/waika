var e=Object.assign;import{_ as n}from"./rank-player.4a000fdc.js";import{R as a}from"./rank.service.b9cb579c.js";import{d as t,r as l,D as o,N as r,p as s,g as _,a as p,o as d,c as u,b as i,h as c,f as m,e as y,F as f,i as v,j as w}from"./index.8f109ae7.js";import"./vendor.da44e350.js";import{$ as h,E as g}from"./event-bus.2e8a8b75.js";l({count:1});var k=t({components:{},emits:["on_update"],props:{player:null},setup(n,{emit:t}){const s=l({count:1,is_show_more:!0}),_=l({on_show_more:null,on_win_player:null});_.on_show_more=e=>{h.emit(g.jifen_show_actions,{player:n.player})};return _.on_win_player=()=>{let e=n.player;o.alert({title:"确认",message:"选手："+e.name+"胜出"}).then((()=>{a.win_player(e),r("选手："+e.name+"胜出"),(()=>{let e=n.player;a.is_player_winning_streak_need_down(e)&&o.confirm({title:"确认",message:"选手："+e.name+"已经"+e.winning_streak+"连胜，是否下场？",beforeClose:n=>("confirm"===n&&(a.down_player([e]),t("on_update")),!0)})})(),t("on_update")}))},e(e({state:s,props:n},_),{data:1})}});const b=c("data-v-36dfc881");s("data-v-36dfc881");const j=m(" 胜出 "),P=m(" 更多 ");_();const x=b(((e,n,a,t,l,o)=>{const r=p("van-cell"),s=p("van-cell-group"),_=p("van-col"),c=p("van-button"),m=p("van-row");return d(),u("div",null,[i(s,{title:e.props.player.idx+" "+e.props.player.name},{default:b((()=>[i(r,{title:"连胜："+e.props.player.winning_streak+" 积分："+e.props.player.score,size:"large"},null,8,["title"])])),_:1},8,["title"]),i(m,{justify:"space-around",gutter:"20"},{default:b((()=>[i(_,{span:"8"}),i(_,{span:"8"},{default:b((()=>[i(c,{type:"primary",size:"large",class:"btn-win",onClick:n[1]||(n[1]=n=>e.on_win_player())},{default:b((()=>[j])),_:1})])),_:1}),i(_,{span:"8"},{default:b((()=>[i(c,{type:"primary",onClick:n[2]||(n[2]=n=>e.on_show_more(1))},{default:b((()=>[P])),_:1})])),_:1})])),_:1})])}));k.render=x,k.__scopeId="data-v-36dfc881";const S=h,J=[];var z=t({components:{},unmounted:()=>{h.remove(J),J.length=0},setup(n){const t=l({count:1,selected_player:null}),o=l({on_count:null,onSelect:null});o.on_count=e=>{};const r=y(!1);var s,_;s=S.jifen_show_actions,_=e=>{r.value=!0,p[0].name=e.player.name+" 下场",t.selected_player=e.player},J.push(h.on(s,_)),o.onSelect=e=>{e.handle&&(e.handle(),r.value=!1)};const p=[{name:"下场",handle:()=>{t.selected_player&&a.down_player([t.selected_player])}},{name:"违体",handle:()=>{a.down_two_player()}},{name:"弃权",handle:()=>{t.selected_player&&a.delete_player(t.selected_player)}},{name:"双人下场",handle:()=>{a.down_two_player()}}];return e({state:t,menus:p,showPopover:r,props:n},o)}});z.render=function(e,n,a,t,l,o){const r=p("van-action-sheet");return d(),u(r,{show:e.showPopover,"onUpdate:show":n[1]||(n[1]=n=>e.showPopover=n),actions:e.menus,onSelect:e.onSelect},null,8,["show","actions","onSelect"])};const A=h,C=[];var O=t({components:{RankPlayer:n,JifenPlayer:k,JifenAction:z},unmounted:()=>{h.remove(C),C.length=0},setup(n){const t=a.state,o=l({on_commit_game:null,get_vs_title:null,on_change:null,on_win_player:null,on_down_winning_streak:null,on_edit_max_winning_streak:null,on_edit_group_name:null,on_update_rank:null}),r=l({checked_edit_mode:y(!1),max_winning_streak:y(5)});a.init_event(),a.load_rank_doc();var s,_;s=A.rank_jifen_vs_changed,_=()=>{a.load_rank_doc()},C.push(h.on(s,_)),o.on_change=()=>{},o.on_update_rank=()=>{a.load_rank_doc()};const p=y(5),d=y("A"),u=y(!0);return e(e({state:t,state_1:r,is_show_more:u,max_winning_streak:p,group_name:d},o),{on_count:e=>{a.count2(e)},data:1})}});const R=c("data-v-3dfa4b64");s("data-v-3dfa4b64");const I=m("VS");_();const D=R(((e,n,a,t,l,o)=>{const r=p("JifenPlayer"),s=p("van-button"),_=p("van-col"),c=p("van-row"),m=p("RankPlayer"),y=p("van-cell-group"),h=p("JifenAction");return d(),u(f,null,[i("div",null,[i(c,null,{default:R((()=>[(d(!0),u(f,null,v(e.state.last_vs_arr,((e,n)=>(d(),u(_,{span:"24",key:n},{default:R((()=>[i(r,{player:e},null,8,["player"]),0==n?(d(),u(c,{key:0,justify:"center"},{default:R((()=>[i(_,{span:"24"},{default:R((()=>[i(s,{plain:"",disabled:"",type:"primary",size:"large"},{default:R((()=>[I])),_:1})])),_:1})])),_:1})):w("",!0)])),_:2},1024)))),128))])),_:1}),i(y,{title:"下一场："},{default:R((()=>[i(c,null,{default:R((()=>[(d(!0),u(f,null,v(e.state.player_arr,((n,a)=>(d(),u(f,{key:n.name},[a>1?(d(),u(m,{key:0,player:n,onOn_update:e.on_update_rank},null,8,["player","onOn_update"])):w("",!0)],64)))),128))])),_:1})])),_:1})]),i(h)],64)}));O.render=D,O.__scopeId="data-v-3dfa4b64";export default O;
