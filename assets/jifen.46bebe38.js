var e=Object.assign;import{_ as n}from"./rank-player.c8cc61a6.js";import{R as a}from"./rank.service.411f0443.js";import{d as t,r as o,$ as l,E as r,D as s,N as _,p as c,h as p,a as u,o as d,c as i,b as m,i as y,f as v,L as f,j as w,g as h,F as k,e as g}from"./index.cac4dc34.js";import"./vendor.da44e350.js";o({count:1});var j=t({components:{},emits:["on_update"],props:{player:null},setup(n,{emit:t}){const c=o({count:1,is_show_more:!0}),p=o({on_show_more:null,on_win_player:null});p.on_show_more=e=>{l.emit(r.jifen_show_actions,{player:n.player})};return p.on_win_player=()=>{let e=n.player;s.alert({title:"确认",message:"选手："+e.name+"胜出"}).then((()=>{a.win_player(e),_("选手："+e.name+"胜出"),(()=>{let e=n.player;a.is_player_winning_streak_need_down(e)&&s.confirm({title:"确认",message:"选手："+e.name+"已经"+e.winning_streak+"连胜，是否下场？",beforeClose:n=>("confirm"===n&&(a.down_player([e]),t("on_update")),!0)})})(),t("on_update")}))},e(e({state:c,props:n},p),{data:1})}});const b=y("data-v-36dfc881");c("data-v-36dfc881");const P=v(" 胜出 "),S=v(" 更多 ");p();const x=b(((e,n,a,t,o,l)=>{const r=u("van-cell"),s=u("van-cell-group"),_=u("van-col"),c=u("van-button"),p=u("van-row");return d(),i("div",null,[m(s,{title:e.props.player.idx+" "+e.props.player.name},{default:b((()=>[m(r,{title:"连胜："+e.props.player.winning_streak+" 积分："+e.props.player.score,size:"large"},null,8,["title"])])),_:1},8,["title"]),m(p,{justify:"space-around",gutter:"20"},{default:b((()=>[m(_,{span:"8"}),m(_,{span:"8"},{default:b((()=>[m(c,{type:"primary",size:"large",class:"btn-win",onClick:n[1]||(n[1]=n=>e.on_win_player())},{default:b((()=>[P])),_:1})])),_:1}),m(_,{span:"8"},{default:b((()=>[m(c,{type:"primary",onClick:n[2]||(n[2]=n=>e.on_show_more(1))},{default:b((()=>[S])),_:1})])),_:1})])),_:1})])}));j.render=x,j.__scopeId="data-v-36dfc881";var J=t({components:{},setup(n){const a=o({count:1,rec_arr:[]}),t=o({on_count:null,on_back_to:null});return t.on_count=e=>{},t.on_back_to=e=>{},f.get_item(f.RANK_KEY,(e=>{let n=JSON.parse(e);(null==n?void 0:n.rank_rec_arr)&&(a.rec_arr=[...n.rank_rec_arr])})),e({state:a,props:n},t)}});J.render=function(e,n,a,t,o,l){return u("van-button"),u("van-cell"),u("van-cell-group"),w("",!0)};const A=l,O=[];var R=t({components:{},unmounted:()=>{},setup(n){const t=o({count:1,selected_player:null}),r=o({on_count:null,onSelect:null});r.on_count=e=>{};const s=h(!1);var _,c;_=A.jifen_show_actions,c=e=>{s.value=!0,p[0].name=e.player.name+" 下场",t.selected_player=e.player},O.push(l.on(_,c)),r.onSelect=e=>{e.handle&&(e.handle(),s.value=!1)};const p=[{name:"下场",handle:()=>{t.selected_player&&a.down_player([t.selected_player])}},{name:"违体",handle:()=>{a.down_two_player()}},{name:"弃权",handle:()=>{t.selected_player&&a.delete_player(t.selected_player)}},{name:"双人下场",handle:()=>{a.down_two_player()}},{name:"回溯",handle:()=>{l.emit(A.jifen_show_history)}}];return e({state:t,menus:p,showPopover:s,props:n},r)}});R.render=function(e,n,a,t,o,l){const r=u("van-action-sheet");return d(),i(r,{show:e.showPopover,"onUpdate:show":n[1]||(n[1]=n=>e.showPopover=n),actions:e.menus,onSelect:e.onSelect},null,8,["show","actions","onSelect"])};const z=l,C=[];var N=t({components:{RankPlayer:n,JifenPlayer:j,History:J,JifenAction:R},unmounted:()=>{},setup(n){const t=a.state,r=o({on_commit_game:null,get_vs_title:null,on_change:null,on_win_player:null,on_down_winning_streak:null,on_edit_max_winning_streak:null,on_edit_group_name:null,on_update_rank:null}),s=o({checked_edit_mode:h(!1),max_winning_streak:h(5)});a.init_event(),a.load_rank_doc();var _,c;_=z.rank_jifen_vs_changed,c=()=>{a.load_rank_doc()},C.push(l.on(_,c)),r.on_change=()=>{},r.on_update_rank=()=>{a.load_rank_doc()};const p=h(5),u=h("A"),d=h(!0);return e(e({state:t,state_1:s,is_show_more:d,max_winning_streak:p,group_name:u},r),{on_count:e=>{a.count2(e)},data:1})}});const E=y("data-v-1a5dec95");c("data-v-1a5dec95");const H=v("VS");p();const I=E(((e,n,a,t,o,l)=>{const r=u("History"),s=u("JifenPlayer"),_=u("van-button"),c=u("van-col"),p=u("van-row"),y=u("RankPlayer"),v=u("van-cell-group"),f=u("JifenAction");return d(),i(k,null,[m(r),m("div",null,[m(p,null,{default:E((()=>[(d(!0),i(k,null,g(e.state.last_vs_arr,((e,n)=>(d(),i(c,{span:"24",key:n},{default:E((()=>[m(s,{player:e},null,8,["player"]),0==n?(d(),i(p,{key:0,justify:"center"},{default:E((()=>[m(c,{span:"24"},{default:E((()=>[m(_,{plain:"",disabled:"",type:"primary",size:"large"},{default:E((()=>[H])),_:1})])),_:1})])),_:1})):w("",!0)])),_:2},1024)))),128))])),_:1}),m(v,{title:"下一场："},{default:E((()=>[m(p,null,{default:E((()=>[(d(!0),i(k,null,g(e.state.player_arr,((n,a)=>(d(),i(k,{key:n.name},[a>1?(d(),i(y,{key:0,player:n,onOn_update:e.on_update_rank},null,8,["player","onOn_update"])):w("",!0)],64)))),128))])),_:1})])),_:1})]),m(f)],64)}));N.render=I,N.__scopeId="data-v-1a5dec95";export default N;
