var e=Object.assign;import{d as a,r as t,a as n,o as l,c as o,w as s,b as _,N as d,$ as i,E as r,u,F as m,e as g,f as c,g as p}from"./index.cac4dc34.js";import{R as v}from"./rank.service.411f0443.js";import{B as f,g as x,R as y}from"./router.service.163df11f.js";import"./vendor.da44e350.js";var h=a({components:{},setup:()=>({state:t({value1:0,value2:"a"}),option1:[{text:"管理员",value:0},{text:"球员",value:1},{text:"计分员",value:2}],option2:[]})});h.render=function(e,a,t,d,i,r){const u=n("van-dropdown-item"),m=n("van-dropdown-menu");return l(),o(m,null,{default:s((()=>[_(u,{modelValue:e.state.value1,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.value1=a),options:e.option1},null,8,["modelValue","options"]),_(u,{modelValue:e.state.value2,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.value2=a),options:e.option2},null,8,["modelValue","options"])])),_:1})};const k="/miniprogram/city/game/list/",w="/api/passerbyking/city/game/player/list/",V=e=>"test"===x("ll_env")?"http://test.liangle.com"+e:"http://m.liangle.com"+e;class C{static async load_player_list(e){let a=V(w+e),t=await f.get_proxy(a);if(t.data)return t.data}static async load_event_list(){let e=V(k),a=await f.get_proxy(e);if(a.data)return a.data}}var b=a({components:{},setup(a){const n=t({count:1,selected_event:null,game_arr:[]}),l=u(),o=t({on_count:null,on_load_liangle_data:null,on_selected_event:null,on_enter_game:null,get_game_desc:null});o.get_game_desc=e=>e.idx+"  人数:"+e.player_arr.length,o.on_selected_event=()=>{var e;if(null==(e=n.selected_event)?void 0:e.id){let e=n.selected_event.id;o.on_load_liangle_data(e)}};const s=[{text:"管理员",value:0},{text:"球员",value:1},{text:"计分员",value:2}];return(async()=>{let e=await C.load_event_list();(null==e?void 0:e.length)&&(s.length=0,e.map((e=>{s.push({text:e.title,value:e})})))})(),o.on_enter_game=e=>{e.player_arr.length>23?(d({type:"success",message:"enter"}),i.emit(r.enter_game,e),y.to(l,"/jifen")):d({type:"danger",message:"人数不足"})},o.on_load_liangle_data=async e=>{e||(e="1801");let a=await C.load_player_list(e),t=[];if(a){d({type:"success",message:"!"});for(let e in a){let n={idx:e,player_arr:a[e]};t.push(n)}n.game_arr=t}},o.on_load_liangle_data(),e({state:n,event_arr:s,props:a},o)}});const j=c(" 刷新 "),R=c(" 进入 ");b.render=function(e,a,t,d,i,r){const u=n("van-dropdown-item"),c=n("van-dropdown-menu"),p=n("van-cell"),v=n("van-button"),f=n("van-cell-group");return l(),o("div",null,[_(p,{title:"比赛列表"},{default:s((()=>[_(c,null,{default:s((()=>[_(u,{modelValue:e.state.selected_event,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.selected_event=a),onChange:e.on_selected_event,options:e.event_arr},null,8,["modelValue","onChange","options"])])),_:1})])),_:1}),_(p,{title:"场次列表"},{default:s((()=>[_(v,{onClick:e.on_load_liangle_data},{default:s((()=>[j])),_:1},8,["onClick"])])),_:1}),_(f,null,{default:s((()=>[(l(!0),o(m,null,g(e.state.game_arr,((a,t)=>(l(),o(p,{key:t,title:a.idx,value:"get_game_desc(game)",label:e.get_game_desc(a)},{default:s((()=>[_(v,{onClick:t=>e.on_enter_game(a)},{default:s((()=>[R])),_:2},1032,["onClick"])])),_:2},1032,["title","label"])))),128))])),_:1})])};const U=[];var A=a({components:{Role:h,GameList:b},unmounted:()=>{i.remove(U),U.length=0},setup(a){v.init_event(),v.load_rank_doc();const t={on_edit_max_winning_streak:null,on_edit_group_name:null,on_load_liangle_data:null},n=p(5),l=p("A");return t.on_edit_max_winning_streak=e=>{v.state.max_winning_streak=n.value},t.on_load_liangle_data=async e=>{},t.on_edit_group_name=e=>{v.set_group_name(l.value)},e(e({state:{},max_winning_streak:n,group_name:l},t),{data:1})}});const G=_("span",{style:{"font-size":"20px"}},null,-1);A.render=function(e,a,t,s,d,i){const r=n("van-field"),u=n("Role"),m=n("GameList"),g=n("RankAction");return l(),o("div",null,[_(r,{onChange:e.on_edit_max_winning_streak,modelValue:e.max_winning_streak,"onUpdate:modelValue":a[1]||(a[1]=a=>e.max_winning_streak=a),label:"最大连胜",placeholder:"请输入"},null,8,["onChange","modelValue"]),_(r,{onChange:e.on_edit_group_name,modelValue:e.group_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.group_name=a),label:"场次名",placeholder:"请输入"},null,8,["onChange","modelValue"]),G,_(u),_(m),_(g)])};export default A;
